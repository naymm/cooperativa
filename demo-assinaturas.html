<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demonstra√ß√£o - Sistema de Assinaturas Mensais</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #1f3664 0%, #2d5aa0 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .content {
            padding: 30px;
        }
        
        .demo-section {
            margin-bottom: 40px;
        }
        
        .demo-section h2 {
            color: #1f3664;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn.danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
        }
        
        .btn.success {
            background: linear-gradient(135deg, #51cf66 0%, #40c057 100%);
        }
        
        .btn.warning {
            background: linear-gradient(135deg, #ffd43b 0%, #fcc419 100%);
            color: #333;
        }
        
        .console {
            background: #1e1e1e;
            color: #00ff00;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            height: 400px;
            overflow-y: auto;
            margin-bottom: 20px;
            border: 2px solid #333;
        }
        
        .console::-webkit-scrollbar {
            width: 8px;
        }
        
        .console::-webkit-scrollbar-track {
            background: #2d2d2d;
        }
        
        .console::-webkit-scrollbar-thumb {
            background: #00ff00;
            border-radius: 4px;
        }
        
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .status-card {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .status-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .status-card h3 {
            margin: 0 0 15px 0;
            color: #1f3664;
            font-size: 1.2em;
        }
        
        .status-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding: 5px 0;
            border-bottom: 1px solid #eee;
        }
        
        .status-item:last-child {
            border-bottom: none;
        }
        
        .status-value {
            font-weight: bold;
            color: #667eea;
        }
        
        .status-value.success {
            color: #51cf66;
        }
        
        .status-value.warning {
            color: #ffd43b;
        }
        
        .status-value.danger {
            color: #ff6b6b;
        }
        
        .cooperado-list {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .cooperado-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
            transition: background-color 0.3s ease;
        }
        
        .cooperado-item:hover {
            background-color: #f8f9fa;
        }
        
        .cooperado-item:last-child {
            border-bottom: none;
        }
        
        .cooperado-info {
            flex: 1;
        }
        
        .cooperado-name {
            font-weight: bold;
            color: #1f3664;
            margin-bottom: 5px;
        }
        
        .cooperado-details {
            font-size: 0.9em;
            color: #666;
        }
        
        .cooperado-status {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
            text-transform: uppercase;
        }
        
        .status-ativo {
            background: #d4edda;
            color: #155724;
        }
        
        .status-suspenso {
            background: #f8d7da;
            color: #721c24;
        }
        
        .status-pendente {
            background: #fff3cd;
            color: #856404;
        }
        
        .clear-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
        }
        
        .clear-btn:hover {
            background: #5a6268;
        }
        
        .emoji {
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Sistema de Assinaturas Mensais</h1>
            <p>Demonstra√ß√£o Interativa do Sistema de Mensalidades Obrigat√≥rias</p>
        </div>
        
        <div class="content">
            <div class="demo-section">
                <h2>üéÆ Controles da Demonstra√ß√£o</h2>
                <div class="controls">
                    <button class="btn" onclick="executarVerificacao()">
                        <span class="emoji">üîç</span>
                        Verificar Assinaturas
                    </button>
                    <button class="btn success" onclick="simularPagamento()">
                        <span class="emoji">üí≥</span>
                        Simular Pagamento
                    </button>
                    <button class="btn warning" onclick="avancarTempo()">
                        <span class="emoji">‚è∞</span>
                        Avan√ßar Tempo
                    </button>
                    <button class="btn" onclick="mostrarStatus()">
                        <span class="emoji">üìä</span>
                        Mostrar Status
                    </button>
                    <button class="btn success" onclick="simularCenarioCompleto()">
                        <span class="emoji">üé¨</span>
                        Simula√ß√£o Completa
                    </button>
                    <button class="btn danger" onclick="limparConsole()">
                        <span class="emoji">üóëÔ∏è</span>
                        Limpar Console
                    </button>
                </div>
            </div>
            
            <div class="demo-section">
                <h2>üì∫ Console de Logs</h2>
                <div id="console" class="console">
                    <div>üöÄ Sistema de Assinaturas Mensais - Demonstra√ß√£o Iniciada</div>
                    <div>üìã Use os controles acima para testar o sistema</div>
                    <div>üí° Execute "Simula√ß√£o Completa" para ver o sistema em a√ß√£o</div>
                    <div></div>
                </div>
            </div>
            
            <div class="demo-section">
                <h2>üìä Status do Sistema</h2>
                <div id="status-grid" class="status-grid">
                    <div class="status-card">
                        <h3>üë• Cooperados</h3>
                        <div class="status-item">
                            <span>Total:</span>
                            <span class="status-value" id="total-cooperados">5</span>
                        </div>
                        <div class="status-item">
                            <span>Ativos:</span>
                            <span class="status-value success" id="cooperados-ativos">4</span>
                        </div>
                        <div class="status-item">
                            <span>Suspensos:</span>
                            <span class="status-value danger" id="cooperados-suspensos">1</span>
                        </div>
                    </div>
                    
                    <div class="status-card">
                        <h3>üí∞ Pagamentos</h3>
                        <div class="status-item">
                            <span>Pendentes:</span>
                            <span class="status-value warning" id="pagamentos-pendentes">0</span>
                        </div>
                        <div class="status-item">
                            <span>Pagos:</span>
                            <span class="status-value success" id="pagamentos-pagos">0</span>
                        </div>
                        <div class="status-item">
                            <span>Em Atraso:</span>
                            <span class="status-value danger" id="pagamentos-atraso">0</span>
                        </div>
                    </div>
                    
                    <div class="status-card">
                        <h3>üìà Estat√≠sticas</h3>
                        <div class="status-item">
                            <span>Taxa de Pagamento:</span>
                            <span class="status-value" id="taxa-pagamento">0%</span>
                        </div>
                        <div class="status-item">
                            <span>Data Atual:</span>
                            <span class="status-value" id="data-atual">15/01/2024</span>
                        </div>
                        <div class="status-item">
                            <span>Verifica√ß√£o Ativa:</span>
                            <span class="status-value success" id="verificacao-ativa">Sim</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="demo-section">
                <h2>üë• Lista de Cooperados</h2>
                <div id="cooperado-list" class="cooperado-list">
                    <!-- Lista ser√° preenchida dinamicamente -->
                </div>
            </div>
        </div>
    </div>

    <script src="DEMO_ASSINATURAS.js"></script>
    <script>
        // Fun√ß√µes para interagir com a interface
        function log(mensagem) {
            const console = document.getElementById('console');
            const timestamp = new Date().toLocaleString('pt-BR');
            console.innerHTML += `<div>[${timestamp}] ${mensagem}</div>`;
            console.scrollTop = console.scrollHeight;
        }

        function executarVerificacao() {
            log("üîç Executando verifica√ß√£o autom√°tica...");
            simulador.verificarAssinaturas();
            atualizarInterface();
        }

        function simularPagamento() {
            const cooperadoId = prompt("Digite o ID do cooperado (coop-1, coop-2, etc.):");
            if (cooperadoId) {
                log(`üí≥ Simulando pagamento para ${cooperadoId}...`);
                simulador.simularPagamento(cooperadoId);
                setTimeout(() => {
                    atualizarInterface();
                }, 2500);
            }
        }

        function avancarTempo() {
            const dias = prompt("Quantos dias avan√ßar?", "5");
            if (dias) {
                log(`‚è∞ Avan√ßando ${dias} dias...`);
                simulador.avancarTempo(parseInt(dias));
                atualizarInterface();
            }
        }

        function mostrarStatus() {
            log("üìä Atualizando status do sistema...");
            simulador.mostrarStatus();
            atualizarInterface();
        }

        function simularCenarioCompleto() {
            log("üé¨ Iniciando simula√ß√£o completa...");
            simulador.simularCenarioCompleto();
            setTimeout(() => {
                atualizarInterface();
            }, 1000);
        }

        function limparConsole() {
            document.getElementById('console').innerHTML = `
                <div>üöÄ Sistema de Assinaturas Mensais - Demonstra√ß√£o Iniciada</div>
                <div>üìã Use os controles acima para testar o sistema</div>
                <div>üí° Execute "Simula√ß√£o Completa" para ver o sistema em a√ß√£o</div>
                <div></div>
            `;
        }

        function atualizarInterface() {
            // Atualizar estat√≠sticas
            const cooperadosAtivos = cooperados.filter(c => c.status === "ativo").length;
            const cooperadosSuspensos = cooperados.filter(c => c.status === "suspenso").length;
            const pagamentosPendentes = pagamentos.filter(p => p.status === "pendente").length;
            const pagamentosPagos = pagamentos.filter(p => p.status === "pago").length;
            const pagamentosAtraso = pagamentos.filter(p => {
                if (p.status === "pendente") {
                    const diasAtraso = Math.floor((simulador.dataAtual - new Date(p.data_vencimento)) / (1000 * 60 * 60 * 24));
                    return diasAtraso > 0;
                }
                return false;
            }).length;
            
            const taxaPagamento = cooperados.length > 0 ? 
                Math.round((pagamentosPagos / cooperados.length) * 100) : 0;

            document.getElementById('total-cooperados').textContent = cooperados.length;
            document.getElementById('cooperados-ativos').textContent = cooperadosAtivos;
            document.getElementById('cooperados-suspensos').textContent = cooperadosSuspensos;
            document.getElementById('pagamentos-pendentes').textContent = pagamentosPendentes;
            document.getElementById('pagamentos-pagos').textContent = pagamentosPagos;
            document.getElementById('pagamentos-atraso').textContent = pagamentosAtraso;
            document.getElementById('taxa-pagamento').textContent = `${taxaPagamento}%`;
            document.getElementById('data-atual').textContent = simulador.dataAtual.toLocaleDateString('pt-BR');

            // Atualizar lista de cooperados
            const cooperadoList = document.getElementById('cooperado-list');
            cooperadoList.innerHTML = '';
            
            cooperados.forEach(cooperado => {
                const plano = planos.find(p => p.id === cooperado.assinatura_plano_id);
                const pagamentosCooperado = pagamentos.filter(p => p.cooperado_id === cooperado.id);
                const pagamentoPendente = pagamentosCooperado.find(p => p.status === "pendente");
                
                let statusClass = 'status-ativo';
                let statusText = 'Ativo';
                
                if (cooperado.status === 'suspenso') {
                    statusClass = 'status-suspenso';
                    statusText = 'Suspenso';
                } else if (pagamentoPendente) {
                    statusClass = 'status-pendente';
                    statusText = 'Pendente';
                }
                
                const diasAtraso = pagamentoPendente ? 
                    Math.floor((simulador.dataAtual - new Date(pagamentoPendente.data_vencimento)) / (1000 * 60 * 60 * 24)) : 0;
                
                cooperadoList.innerHTML += `
                    <div class="cooperado-item">
                        <div class="cooperado-info">
                            <div class="cooperado-name">${cooperado.nome_completo} (${cooperado.numero_associado})</div>
                            <div class="cooperado-details">
                                Plano: ${plano?.nome_plano || 'Sem plano'} | 
                                ${pagamentoPendente ? 
                                    `Pagamento: ${pagamentoPendente.valor.toLocaleString()} Kz (${diasAtraso > 0 ? `${diasAtraso} dias atraso` : 'No prazo'})` : 
                                    'Em dia'
                                }
                            </div>
                        </div>
                        <div class="cooperado-status ${statusClass}">${statusText}</div>
                    </div>
                `;
            });
        }

        // Inicializar interface
        window.addEventListener('load', () => {
            setTimeout(() => {
                atualizarInterface();
                log("‚úÖ Interface inicializada e pronta para demonstra√ß√£o");
            }, 1000);
        });

        // Sobrescrever console.log para mostrar na interface
        const originalLog = console.log;
        console.log = function(...args) {
            originalLog.apply(console, args);
            const mensagem = args.join(' ');
            if (mensagem.includes('[') && mensagem.includes(']')) {
                // √â um log do simulador, n√£o mostrar na interface
                return;
            }
            log(mensagem);
        };
    </script>
</body>
</html>
